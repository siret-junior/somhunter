<!-- 
This file is part of SOMHunter.

Copyright (C) 2020 František Mejzlík <frankmejzlik@gmail.com>
                   Mirek Kratochvil <exa.exa@gmail.com>
                   Patrik Veselý <prtrikvesely@gmail.com>

SOMHunter is free software: you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free
Software Foundation, either version 2 of the License, or (at your option)
any later version.

SOMHunter is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
details.

You should have received a copy of the GNU General Public License along with
SOMHunter. If not, see <https://www.gnu.org/licenses/>.
-->
<!-- Include header -->
<%- include common/header.ejs %>

<section class="ranker-grid-section grid-container">
  <div class="grid-x grid-x align-center">

<!-- ===================================== -->
<!-- Left sidebar: Query builder -->
<!-- ===================================== -->
<div class="ranker-left-sidebar small-3 cell">

  <section class="autocomplete-section ranker-single">
    <form autocomplete="off" class="autocomplete-form grid-container">

    <div class="grid-x align-left grid-padding-x"> 
      <!-- Top buttons -->
      <div class="small-6 cell">
        <a class="button block-btn new-seach-btn" onclick="resetSearchSession()">New search</a>
      </div>
      <div class="small-6 cell">
        <a id="openHelpBtn" data-open="settingsModal" class="button block-btn help-btn">Help</a>
      </div>
    
    </div>

    <!-- ---------------------------------- -->
    <!-- Query inputs -->
    <!-- ---------------------------------- -->    
      <div class="grid-x grid-padding-x align-left"> 

        <!-- Text queries -->
        <div id="textQueries" class="autocomplete-input-cont small-12 cell">
          <h2>Text queries</h2>
          <!-- Autocomplete text input -->  
          <div class="input-cont">
            <input type="text" id="textQueryInput0" class="text-query-input" data-id="2" 
              tabindex="1" name="textQuery[]" value="<%= somhunter.textQueries.q0.value %>">
          </div>
          <p class="inter-query-text"> ... AND THEN ...</p>
          <div class="input-cont">
            <input type="text" id="textQueryInput1" class="text-query-input left-marged" data-id="1" 
              tabindex="2" name="textQuery[]" value="<%= somhunter.textQueries.q1.value %>">
          </div>
                    
        </div>

        <!-- Autocomplete logic -->
        <%- include autocomplete_logic.ejs %>

        <div class="autocomplete-input-cont small-12 cell">
          <a class="button block-btn rescore-btn" onclick="rescore('<%- strs.displayTypes.topn %>')">Rescore to TOP N context [Enter]</a>
          <a class="button block-btn rescore-btn" onclick="rescore('<%- strs.displayTypes.som %>')">Rescore to SOM</a>
        </div>
      </div>
    </form>
  </section>

  <!-- ---------------------------------- -->
  <!-- Control buttons-->
  <!-- ---------------------------------- -->
  <section class="section-control-buttons ">
    <div class="grid-container"> 

      <!-- Screen buttons -->
      <div class="screen-btns grid-padding-x grid-x align-left"> 

        <div class="small-6 cell">
          <a id="btnSom" onclick="showSomDisplay()" class="button block-btn som-screen-btn">SOM Screen [S]</a>
        </div>
        
        <div class="small-6 cell">
          <a id="btnTopn" onclick="showTopDisplay()" class="active button block-btn top-ranked-btn">Top-ranked [SHIFT+T]</a>
        </div>
        <div class="small-6 cell">
        </div>
        <div class="small-6 cell">
          <a id="btnTopnCtx" onclick='showTopDisplay("<%- strs.displayTypes.topnContext %>")' class="active button block-btn top-ranked-btn">Top-ranked context [T]</a>
        </div>

        

      </div>

      <!-- Tips -->
      <div class="screen-btns grid-x align-left"> 

        <ul class="tips-list">
          <li>SHIFT + Mouse Wheel for <span>TEMPORAL CONETXT</span></li>
        </ul>
        
        <h1 id="dresLoginStatusAlt" class="
        <% const srvCfg = coreCfg.submitter_config;
        if (srvCfg.submit_server == "dres" && srvCfg.submit_to_VBS) { %>
          
            <% if (!srvCfg.server_config.dres.loggedIn) { %>
              active
            <% }  %>  
          <% }  %>
          hidden not-logged-in">!!! NOT LOGGED TO THE DRES SERVER !!!</h1>

      </div>

      <!-- Bottom tools panel -->
      <div class="tools-panel bottom grid-x align-left"> 
        <a class="button settings-button" id="dataToolsBtn" data-open="settingsModal">
          <svg class="icon-cog" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" viewBox="0 -256 1792 1792" id="svg3025" version="1.1" inkscape:version="0.48.3.1 r9886" width="100%" height="100%" sodipodi:docname="cog_font_awesome.svg">  <metadata id="metadata3035">    <rdf:RDF>      <cc:Work rdf:about="">        <dc:format>image/svg+xml</dc:format>        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>      </cc:Work>    </rdf:RDF>  </metadata>  <defs id="defs3033"/>  <sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="640" inkscape:window-height="480" id="namedview3031" showgrid="false" inkscape:zoom="0.13169643" inkscape:cx="896" inkscape:cy="896" inkscape:window-x="0" inkscape:window-y="25" inkscape:window-maximized="0" inkscape:current-layer="svg3025"/>  <g transform="matrix(1,0,0,-1,121.49153,1285.4237)" id="g3027">    <path d="m 1024,640 q 0,106 -75,181 -75,75 -181,75 -106,0 -181,-75 -75,-75 -75,-181 0,-106 75,-181 75,-75 181,-75 106,0 181,75 75,75 75,181 z m 512,109 V 527 q 0,-12 -8,-23 -8,-11 -20,-13 l -185,-28 q -19,-54 -39,-91 35,-50 107,-138 10,-12 10,-25 0,-13 -9,-23 -27,-37 -99,-108 -72,-71 -94,-71 -12,0 -26,9 l -138,108 q -44,-23 -91,-38 -16,-136 -29,-186 -7,-28 -36,-28 H 657 q -14,0 -24.5,8.5 Q 622,-111 621,-98 L 593,86 q -49,16 -90,37 L 362,16 Q 352,7 337,7 323,7 312,18 186,132 147,186 q -7,10 -7,23 0,12 8,23 15,21 51,66.5 36,45.5 54,70.5 -27,50 -41,99 L 29,495 Q 16,497 8,507.5 0,518 0,531 v 222 q 0,12 8,23 8,11 19,13 l 186,28 q 14,46 39,92 -40,57 -107,138 -10,12 -10,24 0,10 9,23 26,36 98.5,107.5 72.5,71.5 94.5,71.5 13,0 26,-10 l 138,-107 q 44,23 91,38 16,136 29,186 7,28 36,28 h 222 q 14,0 24.5,-8.5 Q 914,1391 915,1378 l 28,-184 q 49,-16 90,-37 l 142,107 q 9,9 24,9 13,0 25,-10 129,-119 165,-170 7,-8 7,-22 0,-12 -8,-23 -15,-21 -51,-66.5 -36,-45.5 -54,-70.5 26,-50 41,-98 l 183,-28 q 13,-2 21,-12.5 8,-10.5 8,-23.5 z" id="path3029" inkscape:connector-curvature="0" style="fill:currentColor"/>  </g></svg>
        </a>
      </div>
    </div>
  </section>
    

  </div>

<!-- ===================================== -->
<!-- MAIN BODY: Image grid-->
<!-- ===================================== -->
<div id="frameGridWrapper" class="ranker-right-sidebar image-grid-section image-browser-main-tiles small-9 cell grid-container">

  <ul id="frameGrid" class="<%= somhunter.screen.type %>-grid frame-grid grid-x grid-x"></ul>

</div>



<!-- ===================================== -->
<!-- VIDEO DETAIL MODAL -->
<!-- ===================================== -->
<div class="large reveal grid-x" id="modalDetail" data-reveal data-src="999" data-overlay="false">
  
  <button class="close-button" data-close aria-label="Close modal" type="button">
    <span aria-hidden="true">&times;</span>
  </button>

  <ul id="videoDetailFrameGrid" class="detail-grid frame-grid grid-x grid-x">
  </ul>

</div>

<!-- ===================================== -->
<!-- VIDEO REPLAY WINDOW -->
<!-- ===================================== -->
<div class="replay-window replay-stripe" id="replayWindow">

  <ul id="replayWindowFrameGrid" class="replay-grid frame-grid grid-x grid-x"></ul>

</div>

<!-- ===================================== -->
<!-- HELP MODAL -->
<!-- ===================================== -->
<div class="large reveal grid-x" id="modalHelp" data-reveal data-src="999" data-overlay="false">
  
  <button class="close-button" data-close aria-label="Close modal" type="button">
    <span aria-hidden="true">&times;</span>
  </button>

  <h1>Help</h1>
  <p>
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. In in imperdiet enim, eget egestas enim. Aliquam nec ornare ipsum. Nullam ullamcorper dapibus dictum. Nulla semper dapibus eleifend. Sed id nibh vel sapien lobortis commodo a nec orci. Curabitur elit ex, sagittis a aliquet sed, tempus vitae augue. Pellentesque tincidunt, leo non facilisis euismod, diam arcu ultrices turpis, at ultricies arcu tortor quis sem. Nam rutrum convallis malesuada. 
  </p>

</div>

<!-- ===================================== -->
<!-- SETTINGS MODAL -->
<!-- ===================================== -->
<div class="large reveal grid-x" id="settingsModal" data-reveal data-src="999" data-overlay="false">
  
  <button class="close-button" data-close aria-label="Close modal" type="button">
    <span aria-hidden="true">&times;</span>
  </button>

  <%- include settings_panel.ejs %>  

</div>
</section>

<!-- Include footer -->
<%- include common/footer.ejs %>

<%- include somhunter_event_handlers.ejs %>
